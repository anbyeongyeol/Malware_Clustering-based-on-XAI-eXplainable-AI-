import os
import binascii
import shutil

# 필터링 대상 샘플 존재하는 디렉토리
sample_directory = "필터링 대상 샘플 존재하는 디렉토리"
target_dic = "필터린된 샘플이 들어갈 디렉토리"
# MZ.. 문자열 필터링
filter_string = b"4d5a900003000000"

files = os.listdir(sample_directory)
print(f"[+] {len(files)}개의 파일 목록 획득 완료")

# 필터링 된 샘플 
filtered_files = []

for file in files:
    file_path = os.path.join(sample_directory, file)
    with open(file_path, "rb") as f:
        hex_content = binascii.hexlify(f.read())
        #문자열 존재 확인
        if filter_string in hex_content:
            filtered_files.append(file)
            try:
                shutil.move(file_path, target_dic)
            except:
                print("[+] 이미 존재")
