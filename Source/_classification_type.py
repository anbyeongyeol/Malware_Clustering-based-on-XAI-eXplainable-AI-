import pandas as pd
import os

TARGET_TYPE = 'Backdoor'

def re_classification(type):
    # 파일에 존재하는 해시 리스트 획득
    df = pd.read_csv(f"{type}_file.csv")
    hash_list = df['SHA256'].tolist()

    other_list = []
    # 폴더 내 존재하는 파일들의 해시값 획득
    file_list = os.listdir(TARGET_TYPE)
    for fl in file_list:
        filtered_fl = fl[:-4]
        if filtered_fl in hash_list:
            hash_list.remove(filtered_fl)
        else:
            other_list.append(filtered_fl)

    df = pd.DataFrame(hash_list)
    df.columns = ['sha256']
    df.to_csv('not_down_.csv', index=False)
    
    other_df = pd.DataFrame(other_list)
    other_df.columns = ['sha256']
    other_df.to_csv('other.csv', index=False)
    
    
if __name__ == "__main__":
    re_classification(TARGET_TYPE)
