import pandas as pd
import os

def change_csv(path, type):
    csv_df = pd.read_csv(path)
    hash_type_df = csv_df[['SHA256', 'Malware_Type']]
    for ft in type:
        os.mkdir(ft)
        if os.path.isfile(f'{ft}_file.csv'):
            print(f"[+] {ft}_file.csv 파일이 이미 존재합니다.")
            continue
        else: 
            filtered_hash_type_df = hash_type_df[hash_type_df['Malware_Type'] == ft]
            filtered_hash_type_df.to_csv(f"{ft}_file.csv", index=False)
    print("[+] 파일 타입에 맞게 CSV 파일 변환 완료")
