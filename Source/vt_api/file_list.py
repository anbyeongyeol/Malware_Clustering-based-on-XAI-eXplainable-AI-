import pandas as pd
import os

def get_file(file, type):
    json_file_name = []
    # 대상 CSV 로드
    df = pd.read_csv(file)
    csv_file_name = df['SHA256'].to_list()
    
    # Malware 타입 디렉토리가 존재하는지 검사
    if os.path.isdir(f"json_dic\\{type}"):
        print(f"{type} 파일 목록 수집중")
    else:
        os.mkdir(f"json_dic\\{type}")
    try:
        json_file = os.listdir(f'json_dic\\{type}')
        for jf in range(len(json_file)):
            temp = json_file[jf]
            json_file_name.append(temp[:-5])
        print("[+] 총 샘플의 개수 : " + str(len(csv_file_name)))
        print("[+] 기존 진행된 샘플의 개수 : " + str(len(json_file_name)))
        for cr in range(len(json_file_name)):
            csv_file_name.remove(json_file_name[cr])
        print("[+] 이번에 진행될 샘플의 개수 : " + str(len(csv_file_name)))
        return csv_file_name
    except:
        print("[+] 파일 목록 수집 중 에러 발생")
